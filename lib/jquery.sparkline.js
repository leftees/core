/*
 jQuery Sparkline 2.1.2 | http://omnipotent.net/jquery.sparkline | (c) 2012 Splunk, Inc. | BSD */
(function(v,g,k){(function(g){"function"==typeof define&&define.amd?define(["jquery"],g):jQuery&&!jQuery.fn.sparkline&&g(jQuery)})(function(h){var J={},s,A,H,K,G,L,T,U,M,V,W,X,I,Y,Z,E,N,$,aa,ba,O,P,Q,ca,R,S,z,da=0;s=function(){var a,b;return a=function(){this.init.apply(this,arguments)},1<arguments.length?(arguments[0]?(a.prototype=h.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],2<arguments.length&&(b=Array.prototype.slice.call(arguments,
1,-1),b.unshift(a.prototype),h.extend.apply(h,b))):a.prototype=arguments[0],a.prototype.cls=a,a};h.SPFormatClass=A=s({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(a,b){this.format=a;this.fclass=b},render:function(a,b,c){var d=this,e,f,t,g,h;return this.format.replace(this.fre,function(m,n,q,p){var r;return f=n,t=p,e=d.precre.exec(f),e?(h=e[2],f=e[1]):h=!1,g=a[f],g===k?"":t&&b&&b[t]?(r=b[t],r.get?b[t].get(g)||g:b[t][g]||g):(U(g)&&(c.get("numberFormatter")?g=c.get("numberFormatter")(g):
g=X(g,h,c.get("numberDigitGroupCount"),c.get("numberDigitGroupSep"),c.get("numberDecimalMark"))),g)})}});h.spformat=function(a,b){return new A(a,b)};H=function(a,b,c){return a<b?b:a>c?c:a};K=function(a,b){var c;return 2===b?(c=g.floor(a.length/2),a.length%2?a[c]:(a[c-1]+a[c])/2):a.length%2?(c=(a.length*b+b)/4,c%1?(a[g.floor(c)]+a[g.floor(c)-1])/2:a[c-1]):(c=(a.length*b+2)/4,c%1?(a[g.floor(c)]+a[g.floor(c)-1])/2:a[c-1])};G=function(a){var b;switch(a){case "undefined":a=k;break;case "null":a=null;break;
case "true":a=!0;break;case "false":a=!1;break;default:b=parseFloat(a),a==b&&(a=b)}return a};L=function(a){var b,c=[];for(b=a.length;b--;)c[b]=G(a[b]);return c};T=function(a,b){var c,d,e=[];c=0;for(d=a.length;c<d;c++)a[c]!==b&&e.push(a[c]);return e};U=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};X=function(a,b,c,d,e){var f;a=(!1===b?parseFloat(a).toString():a.toFixed(b)).split("");f=0>(f=h.inArray(".",a))?a.length:f;f<a.length&&(a[f]=e);for(b=f-c;0<b;b-=c)a.splice(b,0,d);return a.join("")};
M=function(a,b,c){var d;for(d=b.length;d--;)if(!(c&&null===b[d])&&b[d]!==a)return!1;return!0};W=function(a){return h.isArray(a)?a:[a]};V=function(a){var b;v.createStyleSheet?v.createStyleSheet().cssText=a:(b=v.createElement("style"),b.type="text/css",v.getElementsByTagName("head")[0].appendChild(b),b["string"==typeof v.body.style.WebkitAppearance?"innerText":"innerHTML"]=a)};h.fn.simpledraw=function(a,b,c,d){var e,f;if(c&&(e=this.data("_jqs_vcanvas")))return e;if(!1===h.fn.sparkline.canvas)return!1;
if(h.fn.sparkline.canvas===k)if(c=v.createElement("canvas"),!c.getContext||!c.getContext("2d")){if(!v.namespaces||v.namespaces.v)return h.fn.sparkline.canvas=!1,!1;v.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");h.fn.sparkline.canvas=function(a,b,c,d){return new S(a,b,c)}}else h.fn.sparkline.canvas=function(a,b,c,d){return new R(a,b,c,d)};return a===k&&(a=h(this).innerWidth()),b===k&&(b=h(this).innerHeight()),e=h.fn.sparkline.canvas(a,b,this,d),f=h(this).data("_jqs_mhandler"),
f&&f.registerCanvas(e),e};h.fn.cleardraw=function(){var a=this.data("_jqs_vcanvas");a&&a.reset()};h.RangeMapClass=I=s({init:function(a){var b,c,d=[];for(b in a)a.hasOwnProperty(b)&&"string"==typeof b&&-1<b.indexOf(":")&&(c=b.split(":"),c[0]=0===c[0].length?-Infinity:parseFloat(c[0]),c[1]=0===c[1].length?Infinity:parseFloat(c[1]),c[2]=a[b],d.push(c));this.map=a;this.rangelist=d||!1},get:function(a){var b=this.rangelist,c,d;if((c=this.map[a])!==k)return c;if(b)for(c=b.length;c--;)if(d=b[c],d[0]<=a&&
d[1]>=a)return d[2];return k}});h.range_map=function(a){return new I(a)};Y=s({init:function(a,b){this.$el=h(a);this.options=b;this.currentPageY=this.currentPageX=0;this.el=a;this.splist=[];this.tooltip=null;this.over=!1;this.displayTooltips=!b.get("disableTooltips");this.highlightEnabled=!b.get("disableHighlight")},registerSparkline:function(a){this.splist.push(a);this.over&&this.updateDisplay()},registerCanvas:function(a){var b=h(a.canvas);this.canvas=a;this.$canvas=b;b.mouseenter(h.proxy(this.mouseenter,
this));b.mouseleave(h.proxy(this.mouseleave,this));b.click(h.proxy(this.mouseclick,this))},reset:function(a){this.splist=[];this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=k)},mouseclick:function(a){var b=h.Event("sparklineClick");b.originalEvent=a;b.sparklines=this.splist;this.$el.trigger(b)},mouseenter:function(a){h(v.body).unbind("mousemove.jqs");h(v.body).bind("mousemove.jqs",h.proxy(this.mousemove,this));this.over=!0;this.currentPageX=a.pageX;this.currentPageY=a.pageY;this.currentEl=a.target;
!this.tooltip&&this.displayTooltips&&(this.tooltip=new Z(this.options),this.tooltip.updatePosition(a.pageX,a.pageY));this.updateDisplay()},mouseleave:function(){h(v.body).unbind("mousemove.jqs");var a=this.splist,b=a.length,c=!1,d,e;this.over=!1;this.currentEl=null;this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(e=0;e<b;e++)d=a[e],d.clearRegionHighlight()&&(c=!0);c&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX;this.currentPageY=a.pageY;this.currentEl=a.target;
this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY);this.updateDisplay()},updateDisplay:function(){var a=this.splist,b=a.length,c=!1,d=this.$canvas.offset(),e=this.currentPageX-d.left,f=this.currentPageY-d.top,t,g;if(this.over){for(t=0;t<b;t++)d=a[t],(g=d.setRegionHighlight(this.currentEl,e,f))&&(c=!0);if(c){c=h.Event("sparklineRegionChange");c.sparklines=this.splist;this.$el.trigger(c);if(this.tooltip){c="";for(t=0;t<b;t++)d=a[t],c+=d.getCurrentRegionTooltip();this.tooltip.setContent(c)}this.disableHighlight||
this.canvas.render()}null===g&&this.mouseleave()}}});Z=s({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(a){var b=a.get("tooltipClassname","jqstooltip"),c=this.sizeStyle;this.container=a.get("tooltipContainer")||v.body;this.tooltipOffsetX=a.get("tooltipOffsetX",10);this.tooltipOffsetY=a.get("tooltipOffsetY",12);h("#jqssizetip").remove();h("#jqstooltip").remove();this.sizetip=h("<div/>",{id:"jqssizetip",style:c,
"class":b});this.tooltip=h("<div/>",{id:"jqstooltip","class":b}).appendTo(this.container);a=this.tooltip.offset();this.offsetLeft=a.left;this.offsetTop=a.top;this.hidden=!0;h(window).unbind("resize.jqs scroll.jqs");h(window).bind("resize.jqs scroll.jqs",h.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=h(window).scrollTop();this.scrollLeft=h(window).scrollLeft();this.scrollRight=this.scrollLeft+h(window).width();this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container);
this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(a){a?(this.getSize(a),this.tooltip.html(a).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())):(this.tooltip.css("visibility","hidden"),this.hidden=!0)},updatePosition:function(a,b){if(a===k){if(this.mousex===k)return;a=this.mousex-this.offsetLeft;b=this.mousey-this.offsetTop}else this.mousex=a-=this.offsetLeft,this.mousey=
b-=this.offsetTop;this.height&&(this.width&&!this.hidden)&&(b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b}))},remove:function(){this.tooltip.remove();this.sizetip.remove();this.sizetip=this.tooltip=k;h(window).unbind("resize.jqs scroll.jqs")}});h(function(){V('.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}')});
z=[];h.fn.sparkline=function(a,b){return this.each(function(){var c=new h.fn.sparkline.options(this,b),d=h(this),e,f;e=function(){var b,f,e,g,n;if("html"===a||a===k){b=this.getAttribute(c.get("tagValuesAttribute"));if(b===k||null===b)b=d.html();b=b.replace(/(^\s*\x3c!--)|(--\x3e\s*$)|\s+/g,"").split(",")}else b=a;f="auto"===c.get("width")?b.length*c.get("defaultPixelsPerValue"):c.get("width");if("auto"===c.get("height")){if(!c.get("composite")||!h.data(this,"_jqs_vcanvas"))g=v.createElement("span"),
g.innerHTML="a",d.html(g),e=h(g).innerHeight()||h(g).height(),h(g).remove()}else e=c.get("height");c.get("disableInteraction")?n=!1:(n=h.data(this,"_jqs_mhandler"),n?c.get("composite")||n.reset():(n=new Y(this,c),h.data(this,"_jqs_mhandler",n)));c.get("composite")&&!h.data(this,"_jqs_vcanvas")?h.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),h.data(this,"_jqs_errnotify",!0)):(e=new (h.fn.sparkline[c.get("type")])(this,b,c,
f,e),e.render(),n&&n.registerSparkline(e))};if(h(this).html()&&!c.get("disableHiddenCheck")&&h(this).is(":hidden")||!h(this).parents("body").length){if(!c.get("composite")&&h.data(this,"_jqs_pending"))for(f=z.length;f;f--)z[f-1][0]==this&&z.splice(f-1,1);z.push([this,e]);h.data(this,"_jqs_pending",!0)}else e.call(this)})};h.fn.sparkline.defaults={common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",
enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:k,normalRangeMax:k,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:k,
chartRangeMax:k,chartRangeMinX:k,chartRangeMaxX:k,tooltipFormat:new A('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:"#3366cc #dc3912 #ff9900 #109618 #66aa00 #dd4477 #0099c6 #990099".split(" "),zeroColor:k,nullColor:k,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:k,chartRangeMin:k,chartRangeClip:!1,colorMap:k,tooltipFormat:new A('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},
tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new A('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss","0":"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:k,thresholdValue:0,chartRangeMax:k,chartRangeMin:k,chartRangeClip:!1,tooltipFormat:new A("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe",
"#a8b6ff","#7f94ff"],base:k,tooltipFormat:new A("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:"#3366cc #dc3912 #ff9900 #109618 #66aa00 #dd4477 #0099c6 #990099".split(" "),borderWidth:0,borderColor:"#000",tooltipFormat:new A('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",
medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:k,targetColor:"#4a2",chartRangeMax:k,chartRangeMin:k,tooltipFormat:new A("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}};h.sparkline_display_visible=function(){var a,b,c,d=[];b=0;for(c=z.length;b<c;b++)a=z[b][0],h(a).is(":visible")&&!h(a).parents().is(":hidden")?
(z[b][1].call(a),h.data(z[b][0],"_jqs_pending",!1),d.push(b)):!h(a).closest("html").length&&!h.data(a,"_jqs_pending")&&(h.data(z[b][0],"_jqs_pending",!1),d.push(b));for(b=d.length;b;b--)z.splice(d[b-1],1)};h.fn.sparkline.options=s({init:function(a,b){var c,d,e,f;this.userOptions=b=b||{};this.tag=a;this.tagValCache={};d=h.fn.sparkline.defaults;e=d.common;this.tagOptionsPrefix=b.enableTagOptions&&(b.tagOptionsPrefix||e.tagOptionsPrefix);f=this.getTagSetting("type");f===J?c=d[b.type||e.type]:c=d[f];
this.mergedOptions=h.extend({},e,c,b)},getTagSetting:function(a){var b=this.tagOptionsPrefix,c,d;if(!1===b||b===k)return J;if(this.tagValCache.hasOwnProperty(a))a=this.tagValCache.key;else{a=this.tag.getAttribute(b+a);if(a===k||null===a)a=J;else if("["===a.substr(0,1)){a=a.substr(1,a.length-2).split(",");for(b=a.length;b--;)a[b]=G(a[b].replace(/(^\s*)|(\s*$)/g,""))}else if("{"===a.substr(0,1)){c=a.substr(1,a.length-2).split(",");a={};for(b=c.length;b--;)d=c[b].split(":",2),a[d[0].replace(/(^\s*)|(\s*$)/g,
"")]=G(d[1].replace(/(^\s*)|(\s*$)/g,""))}else a=G(a);this.tagValCache.key=a}return a},get:function(a,b){var c=this.getTagSetting(a),d;return c!==J?c:(d=this.mergedOptions[a])===k?b:d}});h.fn.sparkline._base=s({disabled:!1,init:function(a,b,c,d,e){this.el=a;this.$el=h(a);this.values=b;this.options=c;this.width=d;this.height=e;this.currentRegion=k},initTarget:function(){var a=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),
a))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(a,b){},setRegionHighlight:function(a,b,c){var d=this.currentRegion,e=!this.options.get("disableHighlight"),f;return b>this.canvasWidth||c>this.canvasHeight||0>b||0>c?null:(f=this.getRegion(a,b,c),d!==f?(d!==k&&e&&this.removeHighlight(),this.currentRegion=f,f!==k&&e&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==
k?(this.removeHighlight(),this.currentRegion=k,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(a){},getCurrentRegionTooltip:function(){var a=this.options,b="",c=[],d,e,f,g,w,l,m,n,q;if(this.currentRegion===k)return"";d=this.getCurrentRegionFields();if(e=a.get("tooltipFormatter"))return e(this,a,d);a.get("tooltipChartTitle")&&(b+='<div class="jqs jqstitle">'+a.get("tooltipChartTitle")+"</div>\n");e=this.options.get("tooltipFormat");
if(!e)return"";h.isArray(e)||(e=[e]);h.isArray(d)||(d=[d]);f=this.options.get("tooltipFormatFieldlist");g=this.options.get("tooltipFormatFieldlistKey");if(f&&g){w=[];for(l=d.length;l--;)m=d[l][g],-1!=(q=h.inArray(m,f))&&(w[q]=d[l]);d=w}f=e.length;n=d.length;for(l=0;l<f;l++){m=e[l];"string"==typeof m&&(m=new A(m));g=m.fclass||"jqsfield";for(q=0;q<n;q++)if(!d[q].isNull||!a.get("tooltipSkipNull"))h.extend(d[q],{prefix:a.get("tooltipPrefix"),suffix:a.get("tooltipSuffix")}),w=m.render(d[q],a.get("tooltipValueLookups"),
a),c.push('<div class="'+g+'">'+w+"</div>")}return c.length?b+c.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,b){var c=b.get("highlightColor"),d=b.get("highlightLighten"),e,f,t;if(c)return c;if(d&&(c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a))){f=[];e=4===a.length?16:1;for(t=0;3>t;t++)f[t]=H(g.round(parseInt(c[t+1],16)*e*d),0,255);return"rgb("+f.join(",")+")"}return a}});E={changeHighlight:function(a){var b=
this.currentRegion,c=this.target,d=this.regionShapes[b],e;d&&(e=this.renderRegion(b,a),h.isArray(e)||h.isArray(d)?(c.replaceWithShapes(d,e),this.regionShapes[b]=h.map(e,function(a){return a.id})):(c.replaceWithShape(d,e),this.regionShapes[b]=e.id))},render:function(){var a=this.values,b=this.target,c=this.regionShapes,d,e,f;if(this.cls._super.render.call(this)){for(e=a.length;e--;)if(a=this.renderRegion(e))if(h.isArray(a)){d=[];for(f=a.length;f--;)a[f].append(),d.push(a[f].id);c[e]=d}else a.append(),
c[e]=a.id;else c[e]=null;b.render()}}};h.fn.sparkline.line=N=s(h.fn.sparkline._base,{type:"line",init:function(a,b,c,d,e){N._super.init.call(this,a,b,c,d,e);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.lastShapeId=this.hightlightSpotId=null;this.initTarget()},getRegion:function(a,b,c){c=this.regionMap;for(a=c.length;a--;)if(null!==c[a]&&b>=c[a][0]&&b<=c[a][1])return c[a][2];return k},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:null===
this.yvalues[a],x:this.xvalues[a],y:this.yvalues[a],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:a}},renderHighlight:function(){var a=this.target,b=this.vertices[this.currentRegion],c=this.options,d=c.get("spotRadius"),e=c.get("highlightSpotColor"),c=c.get("highlightLineColor"),f,g;b&&(d&&e&&(f=a.drawCircle(b[0],b[1],d,k,e),this.highlightSpotId=f.id,a.insertAfterShape(this.lastShapeId,f)),c&&(g=a.drawLine(b[0],this.canvasTop,b[0],this.canvasTop+this.canvasHeight,
c),this.highlightLineId=g.id,a.insertAfterShape(this.lastShapeId,g)))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null);this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a=this.values,b=a.length,c=this.xvalues,d=this.yvalues,e=this.yminmax,f,t,h,k,m;for(f=0;f<b;f++)t=a[f],h="string"==typeof a[f],k="object"==typeof a[f]&&a[f]instanceof Array,m=h&&a[f].split(":"),
h&&2===m.length?(c.push(Number(m[0])),d.push(Number(m[1])),e.push(Number(m[1]))):k?(c.push(t[0]),d.push(t[1]),e.push(t[1])):(c.push(f),null===a[f]||"null"===a[f]?d.push(null):(d.push(Number(t)),e.push(Number(t))));this.options.get("xvalues")&&(c=this.options.get("xvalues"));this.maxy=this.maxyorg=g.max.apply(g,e);this.miny=this.minyorg=g.min.apply(g,e);this.maxx=g.max.apply(g,c);this.minx=g.min.apply(g,c);this.xvalues=c;this.yvalues=d;this.yminmax=e},processRangeOptions:function(){var a=this.options,
b=a.get("normalRangeMin"),c=a.get("normalRangeMax");b!==k&&(b<this.miny&&(this.miny=b),c>this.maxy&&(this.maxy=c));a.get("chartRangeMin")!==k&&(a.get("chartRangeClip")||a.get("chartRangeMin")<this.miny)&&(this.miny=a.get("chartRangeMin"));a.get("chartRangeMax")!==k&&(a.get("chartRangeClip")||a.get("chartRangeMax")>this.maxy)&&(this.maxy=a.get("chartRangeMax"));a.get("chartRangeMinX")!==k&&(a.get("chartRangeClipX")||a.get("chartRangeMinX")<this.minx)&&(this.minx=a.get("chartRangeMinX"));a.get("chartRangeMaxX")!==
k&&(a.get("chartRangeClipX")||a.get("chartRangeMaxX")>this.maxx)&&(this.maxx=a.get("chartRangeMaxX"))},drawNormalRange:function(a,b,c,d,e){var f=this.options.get("normalRangeMin"),t=this.options.get("normalRangeMax");b+=g.round(c-c*((t-this.miny)/e));c=g.round(c*(t-f)/e);this.target.drawRect(a,b,d,c,k,this.options.get("normalRangeColor")).append()},render:function(){var a=this.options,b=this.target,c=this.canvasWidth,d=this.canvasHeight,e=this.vertices,f=a.get("spotRadius"),t=this.regionMap,w,l,m,
n,q,p,r,u,D,y,F,s,v,B,z,C,x;if(N._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),z=this.xvalues,C=this.yvalues,this.yminmax.length&&!(2>this.yvalues.length))){n=q=0;w=0===this.maxx-this.minx?1:this.maxx-this.minx;l=0===this.maxy-this.miny?1:this.maxy-this.miny;m=this.yvalues.length-1;f&&(c<4*f||d<4*f)&&(f=0);if(f){if((B=a.get("highlightSpotColor")&&!a.get("disableInteraction"))||a.get("minSpotColor")||a.get("spotColor")&&C[m]===this.miny)d-=g.ceil(f);if(B||a.get("maxSpotColor")||
a.get("spotColor")&&C[m]===this.maxy)d-=g.ceil(f),n+=g.ceil(f);if(B||(a.get("minSpotColor")||a.get("maxSpotColor"))&&(C[0]===this.miny||C[0]===this.maxy))q+=g.ceil(f),c-=g.ceil(f);if(B||a.get("spotColor")||a.get("minSpotColor")||a.get("maxSpotColor")&&(C[m]===this.miny||C[m]===this.maxy))c-=g.ceil(f)}d--;a.get("normalRangeMin")!==k&&!a.get("drawNormalOnTop")&&this.drawNormalRange(q,n,d,c,l);r=[];u=[r];v=null;B=C.length;for(x=0;x<B;x++)D=z[x],F=z[x+1],y=C[x],s=q+g.round((D-this.minx)*(c/w)),F=x<B-
1?q+g.round((F-this.minx)*(c/w)):c,F=s+(F-s)/2,t[x]=[v||0,F,x],v=F,null===y?x&&(null!==C[x-1]&&(r=[],u.push(r)),e.push(null)):(y<this.miny&&(y=this.miny),y>this.maxy&&(y=this.maxy),r.length||r.push([s,n+d]),p=[s,n+g.round(d-d*((y-this.miny)/l))],r.push(p),e.push(p));e=[];t=[];p=u.length;for(x=0;x<p;x++)r=u[x],r.length&&(a.get("fillColor")&&(r.push([r[r.length-1][0],n+d]),t.push(r.slice(0)),r.pop()),2<r.length&&(r[0]=[r[0][0],r[1][1]]),e.push(r));p=t.length;for(x=0;x<p;x++)b.drawShape(t[x],a.get("fillColor"),
a.get("fillColor")).append();a.get("normalRangeMin")!==k&&a.get("drawNormalOnTop")&&this.drawNormalRange(q,n,d,c,l);p=e.length;for(x=0;x<p;x++)b.drawShape(e[x],a.get("lineColor"),k,a.get("lineWidth")).append();if(f&&a.get("valueSpots")){r=a.get("valueSpots");r.get===k&&(r=new I(r));for(x=0;x<B;x++)(u=r.get(C[x]))&&b.drawCircle(q+g.round((z[x]-this.minx)*(c/w)),n+g.round(d-d*((C[x]-this.miny)/l)),f,k,u).append()}f&&a.get("spotColor")&&null!==C[m]&&b.drawCircle(q+g.round((z[z.length-1]-this.minx)*(c/
w)),n+g.round(d-d*((C[m]-this.miny)/l)),f,k,a.get("spotColor")).append();this.maxy!==this.minyorg&&(f&&a.get("minSpotColor")&&(D=z[h.inArray(this.minyorg,C)],b.drawCircle(q+g.round((D-this.minx)*(c/w)),n+g.round(d-d*((this.minyorg-this.miny)/l)),f,k,a.get("minSpotColor")).append()),f&&a.get("maxSpotColor")&&(D=z[h.inArray(this.maxyorg,C)],b.drawCircle(q+g.round((D-this.minx)*(c/w)),n+g.round(d-d*((this.maxyorg-this.miny)/l)),f,k,a.get("maxSpotColor")).append()));this.lastShapeId=b.getLastShapeId();
this.canvasTop=n;b.render()}}});h.fn.sparkline.bar=$=s(h.fn.sparkline._base,E,{type:"bar",init:function(a,b,c,d,e){var f=parseInt(c.get("barWidth"),10),t=parseInt(c.get("barSpacing"),10),w=c.get("chartRangeMin"),l=c.get("chartRangeMax"),m=c.get("chartRangeClip"),n=Infinity,q=-Infinity,p,r,u,D,y,s,v,z,B,A;$._super.init.call(this,a,b,c,d,e);a=0;for(d=b.length;a<d;a++)if(e=b[a],(p="string"==typeof e&&-1<e.indexOf(":"))||h.isArray(e))y=!0,p&&(e=b[a]=L(e.split(":"))),e=T(e,null),p=g.min.apply(g,e),e=g.max.apply(g,
e),p<n&&(n=p),e>q&&(q=e);this.stacked=y;this.regionShapes={};this.barWidth=f;this.barSpacing=t;this.totalBarWidth=f+t;this.width=b.length*f+(b.length-1)*t;this.initTarget();m&&(r=w===k?-Infinity:w,D=l===k?Infinity:l);w=[];f=y?[]:w;l=[];t=[];a=0;for(d=b.length;a<d;a++)if(y){p=b[a];b[a]=z=[];l[a]=0;s=f[a]=t[a]=0;for(v=p.length;s<v;s++)e=z[s]=m?H(p[s],r,D):p[s],null!==e&&(0<e&&(l[a]+=e),0>n&&0<q?0>e?t[a]+=g.abs(e):f[a]+=e:f[a]+=g.abs(e-(0>e?q:n)),w.push(e))}else e=m?H(b[a],r,D):b[a],e=b[a]=G(e),null!==
e&&w.push(e);this.max=m=g.max.apply(g,w);this.min=b=g.min.apply(g,w);this.stackMax=q=y?g.max.apply(g,l):m;this.stackMin=y?g.min.apply(g,w):b;c.get("chartRangeMin")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMin")<b)&&(b=c.get("chartRangeMin"));c.get("chartRangeMax")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMax")>m)&&(m=c.get("chartRangeMax"));this.zeroAxis=n=c.get("zeroAxis",!0);0>=b&&0<=m&&n?u=0:0==n?u=b:0<b?u=b:u=m;this.xaxisOffset=u;r=y?g.max.apply(g,f)+g.max.apply(g,t):m-b;this.canvasHeightEf=
n&&0>b?this.canvasHeight-2:this.canvasHeight-1;b<u?(A=y&&0<=m?q:m,B=(A-u)/r*this.canvasHeight,B!==g.ceil(B)&&(this.canvasHeightEf-=2,B=g.ceil(B))):B=this.canvasHeight;this.yoffset=B;h.isArray(c.get("colorMap"))?(this.colorMapByIndex=c.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=c.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===k&&(this.colorMapByValue=new I(this.colorMapByValue)));this.range=r},getRegion:function(a,b,c){a=g.floor(b/this.totalBarWidth);
return 0>a||a>=this.values.length?k:a},getCurrentRegionFields:function(){var a=this.currentRegion,b=W(this.values[a]),c=[],d,e;for(e=b.length;e--;)d=b[e],c.push({isNull:null===d,value:d,color:this.calcColor(e,d,a),offset:a});return c},calcColor:function(a,b,c){var d=this.colorMapByIndex,e=this.colorMapByValue,f=this.options,g,w;return this.stacked?g=f.get("stackedBarColor"):g=0>b?f.get("negBarColor"):f.get("barColor"),0===b&&f.get("zeroColor")!==k&&(g=f.get("zeroColor")),e&&(w=e.get(b))?g=w:d&&d.length>
c&&(g=d[c]),h.isArray(g)?g[a%g.length]:g},renderRegion:function(a,b){var c=this.values[a],d=this.options,e=this.xaxisOffset,f=[],t=this.range,w=this.stacked,l=this.target,m=a*this.totalBarWidth,n=this.canvasHeightEf,q=this.yoffset,p,r,u,s,y,v,z,A,c=h.isArray(c)?c:[c];v=c.length;s=M(null,c);A=M(e,c,!0);if(s)return d.get("nullColor")?(u=b?d.get("nullColor"):this.calcHighlightColor(d.get("nullColor"),d),p=0<q?q-1:q,l.drawRect(m,p,this.barWidth-1,0,u,u)):k;s=q;for(y=0;y<v;y++){u=c[y];if(w&&u===e){if(!A||
z)continue;z=!0}0<t?r=g.floor(n*(g.abs(u-e)/t))+1:r=1;u<e||u===e&&0===q?(p=s,s+=r):(p=q-r,q-=r);u=this.calcColor(y,u,a);b&&(u=this.calcHighlightColor(u,d));f.push(l.drawRect(m,p,this.barWidth-1,r-1,u,u))}return 1===f.length?f[0]:f}});h.fn.sparkline.tristate=aa=s(h.fn.sparkline._base,E,{type:"tristate",init:function(a,b,c,d,e){var f=parseInt(c.get("barWidth"),10),g=parseInt(c.get("barSpacing"),10);aa._super.init.call(this,a,b,c,d,e);this.regionShapes={};this.barWidth=f;this.barSpacing=g;this.totalBarWidth=
f+g;this.values=h.map(b,Number);this.width=b.length*f+(b.length-1)*g;h.isArray(c.get("colorMap"))?(this.colorMapByIndex=c.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=c.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===k&&(this.colorMapByValue=new I(this.colorMapByValue)));this.initTarget()},getRegion:function(a,b,c){return g.floor(b/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===
k,value:this.values[a],color:this.calcColor(this.values[a],a),offset:a}},calcColor:function(a,b){var c=this.values,d=this.options,e=this.colorMapByIndex,f=this.colorMapByValue,g,h;return f&&(h=f.get(a))?g=h:e&&e.length>b?g=e[b]:0>c[b]?g=d.get("negBarColor"):0<c[b]?g=d.get("posBarColor"):g=d.get("zeroBarColor"),g},renderRegion:function(a,b){var c=this.values,d=this.options,e=this.target,f,h,k,l;h=g.round(e.pixelHeight/2);k=a*this.totalBarWidth;0>c[a]?(l=h,f=h-1):0<c[a]?(l=0,f=h-1):(l=h-1,f=2);c=this.calcColor(c[a],
a);if(null!==c)return b&&(c=this.calcHighlightColor(c,d)),e.drawRect(k,l,this.barWidth-1,f-1,c,c)}});h.fn.sparkline.discrete=ba=s(h.fn.sparkline._base,E,{type:"discrete",init:function(a,b,c,d,e){ba._super.init.call(this,a,b,c,d,e);this.regionShapes={};this.values=b=h.map(b,Number);this.min=g.min.apply(g,b);this.max=g.max.apply(g,b);this.range=this.max-this.min;this.width=d="auto"===c.get("width")?2*b.length:this.width;this.interval=g.floor(d/b.length);this.itemWidth=d/b.length;c.get("chartRangeMin")!==
k&&(c.get("chartRangeClip")||c.get("chartRangeMin")<this.min)&&(this.min=c.get("chartRangeMin"));c.get("chartRangeMax")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMax")>this.max)&&(this.max=c.get("chartRangeMax"));this.initTarget();this.target&&(this.lineHeight="auto"===c.get("lineHeight")?g.round(0.3*this.canvasHeight):c.get("lineHeight"))},getRegion:function(a,b,c){return g.floor(b/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===k,
value:this.values[a],offset:a}},renderRegion:function(a,b){var c=this.options,d=this.min,e=this.range,f=this.interval,h=this.target,k=this.lineHeight,l=this.canvasHeight-k,m,n,q,p;return n=H(this.values[a],d,this.max),p=a*f,m=g.round(l-l*((n-d)/e)),q=c.get("thresholdColor")&&n<c.get("thresholdValue")?c.get("thresholdColor"):c.get("lineColor"),b&&(q=this.calcHighlightColor(q,c)),h.drawLine(p,m,p,m+k,q)}});h.fn.sparkline.bullet=O=s(h.fn.sparkline._base,{type:"bullet",init:function(a,b,c,d,e){var f;
O._super.init.call(this,a,b,c,d,e);this.values=b=L(b);a=b.slice();a[0]=null===a[0]?a[2]:a[0];a[1]=null===b[1]?a[2]:a[1];a=g.min.apply(g,b);f=g.max.apply(g,b);c.get("base")===k?a=0>a?a:0:a=c.get("base");this.min=a;this.max=f;this.range=f-a;this.shapes={};this.valueShapes={};this.regiondata={};this.width=d="auto"===c.get("width")?"4.0em":d;this.target=this.$el.simpledraw(d,e,c.get("composite"));b.length||(this.disabled=!0);this.initTarget()},getRegion:function(a,b,c){a=this.target.getShapeAt(a,b,c);
return a!==k&&this.shapes[a]!==k?this.shapes[a]:k},getCurrentRegionFields:function(){var a=this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.valueShapes[b],d;delete this.shapes[c];switch(b.substr(0,1)){case "r":d=this.renderRange(b.substr(1),a);break;case "p":d=this.renderPerformance(a);break;case "t":d=this.renderTarget(a)}this.valueShapes[b]=d.id;this.shapes[d.id]=b;this.target.replaceWithShape(c,
d)},renderRange:function(a,b){var c=g.round(this.canvasWidth*((this.values[a]-this.min)/this.range)),d=this.options.get("rangeColors")[a-2];return b&&(d=this.calcHighlightColor(d,this.options)),this.target.drawRect(0,0,c-1,this.canvasHeight-1,d,d)},renderPerformance:function(a){var b=g.round(this.canvasWidth*((this.values[1]-this.min)/this.range)),c=this.options.get("performanceColor");return a&&(c=this.calcHighlightColor(c,this.options)),this.target.drawRect(0,g.round(0.3*this.canvasHeight),b-1,
g.round(0.4*this.canvasHeight)-1,c,c)},renderTarget:function(a){var b=g.round(this.canvasWidth*((this.values[0]-this.min)/this.range)-this.options.get("targetWidth")/2),c=g.round(0.1*this.canvasHeight),d=this.canvasHeight-2*c,e=this.options.get("targetColor");return a&&(e=this.calcHighlightColor(e,this.options)),this.target.drawRect(b,c,this.options.get("targetWidth")-1,d-1,e,e)},render:function(){var a=this.values.length,b=this.target,c,d;if(O._super.render.call(this)){for(c=2;c<a;c++)d=this.renderRange(c).append(),
this.shapes[d.id]="r"+c,this.valueShapes["r"+c]=d.id;null!==this.values[1]&&(d=this.renderPerformance().append(),this.shapes[d.id]="p1",this.valueShapes.p1=d.id);null!==this.values[0]&&(d=this.renderTarget().append(),this.shapes[d.id]="t0",this.valueShapes.t0=d.id);b.render()}}});h.fn.sparkline.pie=P=s(h.fn.sparkline._base,{type:"pie",init:function(a,b,c,d,e){var f=0;P._super.init.call(this,a,b,c,d,e);this.shapes={};this.valueShapes={};this.values=b=h.map(b,Number);"auto"===c.get("width")&&(this.width=
this.height);if(0<b.length)for(a=b.length;a--;)f+=b[a];this.total=f;this.initTarget();this.radius=g.floor(g.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(a,b,c){a=this.target.getShapeAt(a,b,c);return a!==k&&this.shapes[a]!==k?this.shapes[a]:k},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===k,value:this.values[a],percent:100*(this.values[a]/this.total),color:this.options.get("sliceColors")[a%this.options.get("sliceColors").length],offset:a}},
changeHighlight:function(a){var b=this.currentRegion;a=this.renderSlice(b,a);var c=this.valueShapes[b];delete this.shapes[c];this.target.replaceWithShape(c,a);this.valueShapes[b]=a.id;this.shapes[a.id]=b},renderSlice:function(a,b){var c=this.target,d=this.options,e=this.radius,f=d.get("borderWidth"),h=d.get("offset"),w=2*g.PI,l=this.values,m=this.total,h=h?2*g.PI*(h/360):0,n,q,p,r,u;r=l.length;for(p=0;p<r;p++){q=n=h;0<m&&(q=h+w*(l[p]/m));if(a===p)return u=d.get("sliceColors")[p%d.get("sliceColors").length],
b&&(u=this.calcHighlightColor(u,d)),c.drawPieSlice(e,e,e-f,n,q,k,u);h=q}},render:function(){var a=this.target,b=this.values,c=this.options,d=this.radius,e=c.get("borderWidth"),f;if(P._super.render.call(this)){e&&a.drawCircle(d,d,g.floor(d-e/2),c.get("borderColor"),k,e).append();for(c=b.length;c--;)b[c]&&(f=this.renderSlice(c).append(),this.valueShapes[c]=f.id,this.shapes[f.id]=c);a.render()}}});h.fn.sparkline.box=Q=s(h.fn.sparkline._base,{type:"box",init:function(a,b,c,d,e){Q._super.init.call(this,
a,b,c,d,e);this.values=h.map(b,Number);this.width="auto"===c.get("width")?"4.0em":d;this.initTarget();this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var a=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==k&&a.push({field:"lo",value:this.loutlier}),this.routlier!==k&&a.push({field:"ro",value:this.routlier}),this.lwhisker!==k&&a.push({field:"lw",value:this.lwhisker}),
this.rwhisker!==k&&a.push({field:"rw",value:this.rwhisker}),a},render:function(){var a=this.target,b=this.values,c=b.length,d=this.options,e=this.canvasWidth,f=this.canvasHeight,h=d.get("chartRangeMin")===k?g.min.apply(g,b):d.get("chartRangeMin"),w=d.get("chartRangeMax")===k?g.max.apply(g,b):d.get("chartRangeMax"),l=0,m,n,q,p,r,u,s,y,v;if(Q._super.render.call(this)){if(d.get("raw"))d.get("showOutliers")&&5<b.length?(n=b[0],m=b[1],p=b[2],r=b[3],u=b[4],s=b[5],y=b[6]):(m=b[0],p=b[1],r=b[2],u=b[3],s=
b[4]);else if(b.sort(function(a,b){return a-b}),p=K(b,1),r=K(b,2),u=K(b,3),q=u-p,d.get("showOutliers")){m=s=k;for(n=0;n<c;n++)m===k&&b[n]>p-q*d.get("outlierIQR")&&(m=b[n]),b[n]<u+q*d.get("outlierIQR")&&(s=b[n]);n=b[0];y=b[c-1]}else m=b[0],s=b[c-1];this.quartiles=[p,r,u];this.lwhisker=m;this.rwhisker=s;this.loutlier=n;this.routlier=y;b=e/(w-h+1);d.get("showOutliers")&&(l=g.ceil(d.get("spotRadius")),e-=2*g.ceil(d.get("spotRadius")),b=e/(w-h+1),n<m&&a.drawCircle((n-h)*b+l,f/2,d.get("spotRadius"),d.get("outlierLineColor"),
d.get("outlierFillColor")).append(),y>s&&a.drawCircle((y-h)*b+l,f/2,d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append());a.drawRect(g.round((p-h)*b+l),g.round(0.1*f),g.round((u-p)*b),g.round(0.8*f),d.get("boxLineColor"),d.get("boxFillColor")).append();a.drawLine(g.round((m-h)*b+l),g.round(f/2),g.round((p-h)*b+l),g.round(f/2),d.get("lineColor")).append();a.drawLine(g.round((m-h)*b+l),g.round(f/4),g.round((m-h)*b+l),g.round(f-f/4),d.get("whiskerColor")).append();a.drawLine(g.round((s-
h)*b+l),g.round(f/2),g.round((u-h)*b+l),g.round(f/2),d.get("lineColor")).append();a.drawLine(g.round((s-h)*b+l),g.round(f/4),g.round((s-h)*b+l),g.round(f-f/4),d.get("whiskerColor")).append();a.drawLine(g.round((r-h)*b+l),g.round(0.1*f),g.round((r-h)*b+l),g.round(0.9*f),d.get("medianColor")).append();d.get("target")&&(v=g.ceil(d.get("spotRadius")),a.drawLine(g.round((d.get("target")-h)*b+l),g.round(f/2-v),g.round((d.get("target")-h)*b+l),g.round(f/2+v),d.get("targetColor")).append(),a.drawLine(g.round((d.get("target")-
h)*b+l-v),g.round(f/2),g.round((d.get("target")-h)*b+l+v),g.round(f/2),d.get("targetColor")).append());a.render()}}});ca=s({init:function(a,b,c,d){this.target=a;this.id=b;this.type=c;this.args=d},append:function(){return this.target.appendShape(this),this}});E=s({_pxregex:/(\d+)(px)?\s*$/i,init:function(a,b,c){a&&(this.width=a,this.height=b,this.target=c,this.lastShapeId=null,c[0]&&(c=c[0]),h.data(c,"_jqs_vcanvas",this))},drawLine:function(a,b,c,d,e,f){return this.drawShape([[a,b],[c,d]],e,f)},drawShape:function(a,
b,c,d){return this._genShape("Shape",[a,b,c,d])},drawCircle:function(a,b,c,d,e,f){return this._genShape("Circle",[a,b,c,d,e,f])},drawPieSlice:function(a,b,c,d,e,f,g){return this._genShape("PieSlice",[a,b,c,d,e,f,g])},drawRect:function(a,b,c,d,e,f){return this._genShape("Rect",[a,b,c,d,e,f])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(a,b){h(b).html(a)},_calculatePixelDims:function(a,
b,c){(b=this._pxregex.exec(b))?this.pixelHeight=b[1]:this.pixelHeight=h(c).height();(b=this._pxregex.exec(a))?this.pixelWidth=b[1]:this.pixelWidth=h(c).width()},_genShape:function(a,b){var c=da++;return b.unshift(c),new ca(this,c,a,b)},appendShape:function(a){alert("appendShape not implemented")},replaceWithShape:function(a,b){alert("replaceWithShape not implemented")},insertAfterShape:function(a,b){alert("insertAfterShape not implemented")},removeShapeId:function(a){alert("removeShapeId not implemented")},
getShapeAt:function(a,b,c){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});R=s(E,{init:function(a,b,c,d){R._super.init.call(this,a,b,c);this.canvas=v.createElement("canvas");c[0]&&(c=c[0]);h.data(c,"_jqs_vcanvas",this);h(this.canvas).css({display:"inline-block",width:a,height:b,verticalAlign:"top"});this._insert(this.canvas,c);this._calculatePixelDims(a,b,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=d;this.shapes=
{};this.shapeseq=[];this.currentTargetShapeId=k;h(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,b,c){var d=this.canvas.getContext("2d");return a!==k&&(d.strokeStyle=a),d.lineWidth=c===k?1:c,b!==k&&(d.fillStyle=b),d},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=k},_drawShape:function(a,b,c,d,e){e=this._getContext(c,d,e);var f,g;e.beginPath();e.moveTo(b[0][0]+
0.5,b[0][1]+0.5);f=1;for(g=b.length;f<g;f++)e.lineTo(b[f][0]+0.5,b[f][1]+0.5);c!==k&&e.stroke();d!==k&&e.fill();this.targetX!==k&&this.targetY!==k&&e.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawCircle:function(a,b,c,d,e,f,h){h=this._getContext(e,f,h);h.beginPath();h.arc(b,c,d,0,2*g.PI,!1);this.targetX!==k&&this.targetY!==k&&h.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a);e!==k&&h.stroke();f!==k&&h.fill()},_drawPieSlice:function(a,b,c,d,e,
f,g,h){var l=this._getContext(g,h);l.beginPath();l.moveTo(b,c);l.arc(b,c,d,e,f,!1);l.lineTo(b,c);l.closePath();g!==k&&l.stroke();h&&l.fill();this.targetX!==k&&this.targetY!==k&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+e],[b,c+e],[b,c]],f,g)},appendShape:function(a){return this.shapes[a.id]=a,this.shapeseq.push(a.id),this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=this.shapeseq,
d;this.shapes[b.id]=b;for(d=c.length;d--;)c[d]==a&&(c[d]=b.id);delete this.shapes[a]},replaceWithShapes:function(a,b){var c=this.shapeseq,d={},e,f,g;for(f=a.length;f--;)d[a[f]]=!0;for(f=c.length;f--;)e=c[f],d[e]&&(c.splice(f,1),delete this.shapes[e],g=f);for(f=b.length;f--;)c.splice(g,0,b[f].id),this.shapes[b[f].id]=b[f]},insertAfterShape:function(a,b){var c=this.shapeseq,d;for(d=c.length;d--;)if(c[d]===a){c.splice(d+1,0,b.id);this.shapes[b.id]=b;break}},removeShapeId:function(a){var b=this.shapeseq,
c;for(c=b.length;c--;)if(b[c]===a){b.splice(c,1);break}delete this.shapes[a]},getShapeAt:function(a,b,c){return this.targetX=b,this.targetY=c,this.render(),this.currentTargetShapeId},render:function(){var a=this.shapeseq,b=this.shapes,c=a.length,d,e;this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight);for(e=0;e<c;e++)d=a[e],d=b[d],this["_draw"+d.type].apply(this,d.args);this.interact||(this.shapes={},this.shapeseq=[])}});S=s(E,{init:function(a,b,c){S._super.init.call(this,a,b,c);c[0]&&
(c=c[0]);h.data(c,"_jqs_vcanvas",this);this.canvas=v.createElement("span");h(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:a,height:b,margin:"0px",padding:"0px",verticalAlign:"top"});this._insert(this.canvas,c);this._calculatePixelDims(a,b,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.canvas.insertAdjacentHTML("beforeEnd",'<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+
this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>');this.group=h(this.canvas).children()[0];this.rendered=!1;this.prerender=""},_drawShape:function(a,b,c,d,e){var f=[],g,h,l,m,n,q,p;p=0;for(q=b.length;p<q;p++)f[p]=""+b[p][0]+","+b[p][1];return g=f.splice(0,1),e=e===k?1:e,h=c===k?' stroked="false" ':' strokeWeight="'+e+'px" strokeColor="'+c+'" ',l=d===k?' filled="false"':' fillColor="'+d+'" filled="true" ',m=f[0]===f[f.length-1]?"x ":"",n='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+
" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+h+l+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+g+" l "+f.join(", ")+" "+m+'e"> </v:shape>',n},_drawCircle:function(a,b,c,d,e,f,g){var h,l,m;return b-=d,c-=d,h=e===k?' stroked="false" ':' strokeWeight="'+g+'px" strokeColor="'+e+'" ',l=f===k?' filled="false"':' fillColor="'+f+'" filled="true" ',m='<v:oval  id="jqsshape'+a+'" '+h+l+' style="position:absolute;top:'+
c+"px; left:"+b+"px; width:"+2*d+"px; height:"+2*d+'px"></v:oval>',m},_drawPieSlice:function(a,b,c,d,e,f,h,s){var l,m,n,q,p,r,u,v;if(e===f)return"";f-e===2*g.PI&&(e=0,f=2*g.PI);m=b+g.round(g.cos(e)*d);n=c+g.round(g.sin(e)*d);q=b+g.round(g.cos(f)*d);p=c+g.round(g.sin(f)*d);if(m===q&&n===p){if(f-e<g.PI)return"";m=q=b+d;n=p=c}return m===q&&n===p&&f-e<g.PI?"":(l=[b-d,c-d,b+d,c+d,m,n,q,p],r=h===k?' stroked="false" ':' strokeWeight="1px" strokeColor="'+h+'" ',u=s===k?' filled="false"':' fillColor="'+s+
'" filled="true" ',v='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+r+u+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+b+","+c+" wa "+l.join(", ")+' x e"> </v:shape>',v)},_drawRect:function(a,b,c,d,e,f,g){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,g)},reset:function(){this.group.innerHTML=""},appendShape:function(a){var b=this["_draw"+
a.type].apply(this,a.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",b):this.prerender+=b,this.lastShapeId=a.id,a.id},replaceWithShape:function(a,b){var c=h("#jqsshape"+a),d=this["_draw"+b.type].apply(this,b.args);c[0].outerHTML=d},replaceWithShapes:function(a,b){var c=h("#jqsshape"+a[0]),d="",e=b.length,f;for(f=0;f<e;f++)d+=this["_draw"+b[f].type].apply(this,b[f].args);c[0].outerHTML=d;for(f=1;f<a.length;f++)h("#jqsshape"+a[f]).remove()},insertAfterShape:function(a,b){var c=
h("#jqsshape"+a),d=this["_draw"+b.type].apply(this,b.args);c[0].insertAdjacentHTML("afterEnd",d)},removeShapeId:function(a){a=h("#jqsshape"+a);this.group.removeChild(a[0])},getShapeAt:function(a,b,c){return a.id.substr(8)},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);
